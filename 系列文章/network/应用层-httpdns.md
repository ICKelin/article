## httpdns

之前的[dns系统](应用层-dns系统.md)记录了对DNS的一些理解，DNS是运行在UDP之上的，不加密的传输，DNS是一个逐级缓存的分布式存储系统，因此可能回造成一些问题：

- 由于没有进行加密，因此可能会被中间的DNS服务器进行劫持，修改返回结果
- 由于是分布式存储系统，为了提升解析效率，每一级的DNS可能都会带有缓存，这个带来的坏处是当我们要修改解析记录进行流量切换时，解析生效就非常不及时。

主要的应对方式一种是加密传输，另外一种是使用httpdns，本文主要阐述的是httpdns的原理以及一些应用场景。

## httpdns的原理
httpdns简单概括起来就是通过一个http接口去做域名解析而不是通过传统的dns进行域名解析，app在使用期间首先调用一个http接口，将需要解析的域名作为请求参数传入，比如：

`curl https://1.1.1.1?host=www.baidu.com`

httpdns虽然**看起来**很简单，但是能解决以下问题：

**避免流量劫持**

由于使用https，数据加密，运营商无法做到劫持。

**能够获得更加精准的客户端IP，从而实现精准调度**

比如我们边缘动态加速节点有几千个，分布在各个省市，那么就可以根据客户端的IP返回最近的节点供接入，而如果使用基于UDP的DNS，能拿到的客户端的IP是localDNS的IP，跟公网IP并不一定对等。

**更多的控制**

比如
